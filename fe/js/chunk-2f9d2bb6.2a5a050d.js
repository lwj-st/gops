(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2f9d2bb6"],{"51a8":function(e,t,a){"use strict";a("f4a5")},"5cd8":function(e,t,a){"use strict";a.r(t);a("a450");var r=function(){var e=this,t=e._self._c;return t("el-container",{staticStyle:{height:"100%",border:"1px solid #eee"}},[t("el-main",[e._v("\n    产品线:\n    "),t("el-cascader",{staticStyle:{width:"300px"},attrs:{options:e.nodes,props:{label:"title",value:"id",multiple:!1},clearable:""},on:{change:e.clearCascader}}),e._v("\n    上线人:\n    "),t("el-select",{staticStyle:{width:"120px","margin-right":"5px"},attrs:{"value-key":"value",filterable:"",clearable:"",placeholder:"请选择上线人 可选"},model:{value:e.operator,callback:function(t){e.operator="string"===typeof t?t.trim():t},expression:"operator"}},e._l(e.users,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.username}})})),1),t("el-date-picker",{staticStyle:{width:"340px","margin-right":"5px"},attrs:{prop:"a","picker-options":e.pickerOptions,type:"datetimerange",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.dtrange,callback:function(t){e.dtrange=t},expression:"dtrange"}}),t("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.searchAuditHandler}},[e._v("搜索")]),t("el-divider"),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.tableData,"header-cell-style":{background:"#eef1f6",color:"#606266"}}},[t("el-table-column",{attrs:{prop:"pdl",label:"产品线",width:"140"}}),t("el-table-column",{attrs:{prop:"name",label:"任务名称",width:"140"}}),t("el-table-column",{attrs:{prop:"env",label:"上线环境",width:"140"},scopedSlots:e._u([{key:"default",fn:function(a){return["dev"==a.row.env?t("span",[e._v("开发环境")]):e._e(),"test"==a.row.env?t("span",[e._v("测试环境")]):e._e(),"prod"==a.row.env?t("span",[e._v("生产环境")]):e._e()]}}])}),t("el-table-column",{attrs:{prop:"image",label:"镜像"}}),t("el-table-column",{attrs:{prop:"operator",label:"操作人"}}),t("el-table-column",{attrs:{prop:"percentage",label:"运行状态"},scopedSlots:e._u([{key:"default",fn:function(e){return[t("el-progress",{attrs:{percentage:e.row.percentage,status:e.row.status}})]}}])}),t("el-table-column",{attrs:{prop:"created_at",label:"上线时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(e._f("formatTime")(t.row.created_at))+"\n        ")]}}])}),t("el-table-column",{attrs:{prop:"result",label:"上线结果",width:"140"},scopedSlots:e._u([{key:"default",fn:function(a){return[1==a.row.result?t("span",[e._v("成功")]):e._e(),2==a.row.result?t("span",[t("el-tooltip",{staticClass:"item",attrs:{content:a.row.reason,placement:"left"}},[t("el-button",[e._v("失败")])],1)],1):e._e()]}}])})],1),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{"current-page":e.cur_page,"page-size":e.page_size,layout:"total, prev, pager, next",total:e.auditCounts},on:{"current-change":e.auditPageHandler,"update:currentPage":function(t){e.cur_page=t},"update:current-page":function(t){e.cur_page=t}}})],1)],1)],1)},n=[],s=(a("ac67"),a("1bc7"),a("32ea"),a("4057"),a("e186"),a("bff1")),i=a("a483"),o=a("7736");function u(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?u(Object(a),!0).forEach((function(t){Object(i["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):u(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var l={data:function(){return{loading:!1,tableData:void 0,auditCounts:0,cur_page:1,page_size:20,page_total:1,node_id:void 0,nodes:void 0,timer:"",dtrange:[],operator:"",users:[],pickerOptions:{shortcuts:[{text:"今天（此刻）",onClick:function(e){var t=new Date;t.setTime(t.getTime()),t.setHours(t.getHours()),t.setMinutes(t.getMinutes()),t.setSeconds(t.getSeconds());var a=new Date;a.setTime(a.getTime()),a.setHours(0),a.setMinutes(0),a.setSeconds(0),e.$emit("pick",[a,t])}},{text:"昨天",onClick:function(e){var t=new Date;t.setTime(t.getTime()-864e5),t.setHours(23),t.setMinutes(59),t.setSeconds(59);var a=new Date;a.setTime(a.getTime()-864e5),a.setHours(0),a.setMinutes(0),a.setSeconds(0),e.$emit("pick",[a,t])}},{text:"最近一周",onClick:function(e){var t=new Date;t.setHours(23),t.setMinutes(59),t.setSeconds(59);var a=new Date;a.setTime(a.getTime()-5184e5),a.setHours(0),a.setMinutes(0),a.setSeconds(0),e.$emit("pick",[a,t])}},{text:"最近30天",onClick:function(e){var t=new Date;t.setHours(23),t.setMinutes(59),t.setSeconds(59);var a=new Date;a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setTime(a.getTime()-25056e5),e.$emit("pick",[a,t])}},{text:"最近90天",onClick:function(e){var t=new Date;t.setHours(23),t.setMinutes(59),t.setSeconds(59);var a=new Date;a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}},{text:"最近一年",onClick:function(e){var t=new Date;t.setHours(23),t.setMinutes(59),t.setSeconds(59);var a=new Date;a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setTime(a.getTime()-31536e6),e.$emit("pick",[a,t])}}]}}},components:{},computed:{data:function(){return{tableData:this.$store.state.auditData.data,auditCounts:this.$store.state.auditData.total}}},beforeDestroy:function(){clearInterval(this.timer)},destroyed:function(){clearInterval(this.timer)},watch:{filterText:function(e){this.$refs.SlotMenuList.filter(e)},"$route.query":{handler:function(){var e=this;void 0!=this.$route.query.id?(this.searchById(this.$route.query.id),this.timer=setInterval((function(){return e.searchById(e.$route.query.id)}),1e4)):this.getData()},immediate:!0}},methods:c(c({},Object(o["b"])(["getAudits","getNodes","getTreeMenus","getAccounts"])),{},{getData:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getAccounts({name:this.username,page:this.cur_page,pageSize:1e3});case 2:return this.users=this.$store.state.userData.data,e.next=5,this.getAudits({page:this.cur_page,pageSize:this.page_size});case 5:return this.tableData=this.$store.state.auditData.data,this.auditCounts=this.$store.state.auditData.total,e.next=9,this.getTreeMenus();case 9:t=JSON.parse(this.$store.state.treeMenus.data),this.nodes=t;case 11:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),sleep:function(e){return new Promise((function(t){return setTimeout(t,e)}))},searchById:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getAudits({id:t});case 2:this.tableData=this.$store.state.auditData.data,this.auditCounts=this.$store.state.auditData.total;case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),clearCascader:function(e){0!=e.length&&(this.node_id=e[e.length-1])},auditPageHandler:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=null===this.dtrange?"":this.dtrange.length>0?this.dtrange.toString():"",e.next=3,this.getAudits({node_id:this.node_id,operator:this.operator,dtrange:a,page:this.cur_page,pageSize:this.page_size});case 3:this.tableData=this.$store.state.auditData.data,this.auditCounts=this.$store.state.auditData.total;case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),searchAuditHandler:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=null===this.dtrange?"":this.dtrange.length>0?this.dtrange.toString():"",this.cur_page=1,e.next=4,this.getAudits({node_id:this.node_id,operator:this.operator,dtrange:t,page:this.cur_page,pageSize:this.page_size});case 4:this.tableData=this.$store.state.auditData.data,this.auditCounts=this.$store.state.auditData.total;case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()})},d=l,p=(a("51a8"),a("0b56")),h=Object(p["a"])(d,r,n,!1,null,"47ba3c51",null);t["default"]=h.exports},f4a5:function(e,t,a){}}]);