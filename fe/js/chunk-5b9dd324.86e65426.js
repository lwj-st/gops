(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5b9dd324"],{2687:function(e,t,a){"use strict";a.r(t);a("fc02"),a("a450");var r=function(){var e=this,t=e._self._c;return t("el-container",{staticStyle:{height:"100%",border:"1px solid #eee"}},[t("el-main",[e._v("\n    产品线:\n    "),t("el-cascader",{staticStyle:{width:"300px"},attrs:{options:e.nodes,props:{label:"title",value:"id",multiple:!1},clearable:""},on:{change:e.setSearchNodeId}}),e._v("\n    级别:\n    "),t("el-select",{staticStyle:{width:"80px"},attrs:{"value-key":"value",filterable:"",clearable:"",placeholder:"请选择告警级别"},model:{value:e.level,callback:function(t){e.level="string"===typeof t?t.trim():t},expression:"level"}},e._l(e.levels,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.value}})})),1),t("el-date-picker",{staticStyle:{width:"340px","margin-left":"10px","margin-right":"10px"},attrs:{"picker-options":e.pickerOptions,type:"datetimerange",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.dtrange,callback:function(t){e.dtrange=t},expression:"dtrange"}}),t("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.searchHistoryHandler}},[e._v("搜索")]),t("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.problemHandler}},[e._v("未恢复告警")]),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.tableData,"header-cell-style":{background:"#eef1f6",color:"#606266"}}},[t("el-table-column",{attrs:{prop:"status",label:"告警状态",width:"140"},scopedSlots:e._u([{key:"default",fn:function(a){return[1===a.row.status?t("span",[e._v("OK")]):e._e(),0===a.row.status?t("span",[e._v("PROBLEM")]):e._e()]}}])}),t("el-table-column",{attrs:{prop:"title",label:"告警主题",width:"140"}}),t("el-table-column",{attrs:{prop:"rule",label:"告警规则",width:"140"}}),t("el-table-column",{attrs:{prop:"level",label:"级别"}}),t("el-table-column",{attrs:{prop:"node_path",label:"关联产品线数"},scopedSlots:e._u([{key:"default",fn:function(a){return[""===a.row.node_path.split(",")[0]?t("span",[e._v("0")]):t("span",[e._v("   "+e._s(a.row.node_path.split(",").length))])]}}])}),t("el-table-column",{attrs:{prop:"sla",label:"通知人"},scopedSlots:e._u([{key:"default",fn:function(a){return[""===a.row.sla.split(",")[0]?t("span",[e._v("0")]):t("span",[e._v(" "+e._s(a.row.sla.split(",").length))])]}}])}),t("el-table-column",{attrs:{prop:"created_at",width:"150",align:"center",label:"告警时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(e._f("formatTime")(t.row.created_at))+"\n        ")]}}])}),t("el-table-column",{attrs:{prop:"updated_at",width:"150",align:"center",label:"更新时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(e._f("formatTime")(t.row.updated_at))+"\n        ")]}}])}),t("el-table-column",{attrs:{label:"操作",width:"240",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{staticClass:"cadetblue",attrs:{type:"text",icon:"el-icon-setting"},on:{click:function(t){return e.maintain(a.$index,a.row)}}},[e._v("静默")]),1===a.row.category?t("el-button",{staticClass:"cadetblue",attrs:{type:"text",icon:"el-icon-check"},on:{click:function(t){return e.recoryHistory(a.$index,a.row)}}},[e._v("恢复")]):e._e(),t("el-button",{staticClass:"cadetblue",attrs:{type:"text",icon:"el-icon-document"},on:{click:function(t){return e.detail(a.$index,a.row)}}},[e._v("详情")])]}}])})],1),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{"current-page":e.cur_page,"page-size":e.page_size,layout:"total, prev, pager, next",total:e.historyCounts},on:{"current-change":e.historyPageHandler,"update:currentPage":function(t){e.cur_page=t},"update:current-page":function(t){e.cur_page=t}}})],1),t("el-dialog",{attrs:{title:"告警详情",visible:e.historyDetailVisable,width:"80%"},on:{"update:visible":function(t){e.historyDetailVisable=t},close:function(t){e.historyDetailVisable=!1}}},[t("el-divider"),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.detailData,"header-cell-style":{background:"#eef1f6",color:"#606266"}}},[t("el-table-column",{attrs:{prop:"created_at",label:"时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(e._f("formatTime")(t.row.created_at))+"\n          ")]}}])}),t("el-table-column",{attrs:{prop:"status",label:"告警状态",width:"140"},scopedSlots:e._u([{key:"default",fn:function(a){return[1===a.row.status?t("span",[e._v("OK")]):e._e(),0===a.row.status?t("span",[e._v("PROBLEM")]):e._e()]}}])}),t("el-table-column",{attrs:{prop:"title",label:"告警主题",width:"140"}}),t("el-table-column",{attrs:{prop:"text",label:"告警信息"}}),t("el-table-column",{attrs:{prop:"ip",label:"IP"}}),t("el-table-column",{attrs:{prop:"instance_name",label:"主机"}}),t("el-table-column",{attrs:{prop:"level",label:"级别"}}),t("el-table-column",{attrs:{prop:"node_path",label:"关联产品线"},scopedSlots:e._u([{key:"default",fn:function(a){return e._l(a.row.node_path.split(","),(function(a){return t("div",{key:a},[e._v("\n                "+e._s(a)+"\n              ")])}))}}])}),t("el-table-column",{attrs:{prop:"sla",label:"负责人"},scopedSlots:e._u([{key:"default",fn:function(a){return e._l(a.row.sla.split(","),(function(a){return t("div",{key:a},[e._v("\n                "+e._s(a)+"\n              ")])}))}}])})],1)],1),t("el-dialog",{attrs:{title:"告警延迟",visible:e.delayDetailVisable,width:"45%"},on:{"update:visible":function(t){e.delayDetailVisable=t},close:function(t){e.delayDetailVisable=!1}}},[t("el-divider"),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.delayData,"header-cell-style":{background:"#eef1f6",color:"#606266"}}},[t("el-table-column",{attrs:{prop:"ding_since",label:"发送钉钉耗时",width:"140"}}),t("el-table-column",{attrs:{prop:"handle_since",label:"处理告警耗时",width:"140"}}),t("el-table-column",{attrs:{prop:"strategy_name",label:"应用策略",width:"140"}}),t("el-table-column",{attrs:{prop:"strategy_rule",label:"策略规则",width:"300"}})],1)],1)],1)],1)},n=[],s=(a("ac67"),a("1bc7"),a("32ea"),a("4057"),a("e186"),a("bff1")),i=a("a483"),o=a("7736");function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){Object(i["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var u={data:function(){return{loading:!1,tableData:void 0,historyDetailVisable:!1,delayDetailVisable:!1,delayData:void 0,historyCounts:0,cur_page:1,page_size:20,page_total:1,detailData:[],node_path:"",nodePaths:void 0,nodes:"",dtrange:[],level:"",levels:[{id:1,name:"P0",value:"P0"},{id:2,name:"P1",value:"P1"},{id:3,name:"P2",value:"P2"},{id:4,name:"P3",value:"P3"}],category:void 0,categorys:[{id:2,name:"日志告警"},{id:1,name:"基础告警"}],alarmd:void 0,pickerOptions:{shortcuts:[{text:"今天（此刻）",onClick:function(e){var t=new Date;t.setTime(t.getTime()),t.setHours(t.getHours()),t.setMinutes(t.getMinutes()),t.setSeconds(t.getSeconds());var a=new Date;a.setTime(a.getTime()),a.setHours(0),a.setMinutes(0),a.setSeconds(0),e.$emit("pick",[a,t])}},{text:"昨天",onClick:function(e){var t=new Date;t.setTime(t.getTime()-864e5),t.setHours(23),t.setMinutes(59),t.setSeconds(59);var a=new Date;a.setTime(a.getTime()-864e5),a.setHours(0),a.setMinutes(0),a.setSeconds(0),e.$emit("pick",[a,t])}},{text:"最近一周",onClick:function(e){var t=new Date;t.setHours(23),t.setMinutes(59),t.setSeconds(59);var a=new Date;a.setTime(a.getTime()-5184e5),a.setHours(0),a.setMinutes(0),a.setSeconds(0),e.$emit("pick",[a,t])}},{text:"最近30天",onClick:function(e){var t=new Date;t.setHours(23),t.setMinutes(59),t.setSeconds(59);var a=new Date;a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setTime(a.getTime()-25056e5),e.$emit("pick",[a,t])}},{text:"最近90天",onClick:function(e){var t=new Date;t.setHours(23),t.setMinutes(59),t.setSeconds(59);var a=new Date;a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}},{text:"最近一年",onClick:function(e){var t=new Date;t.setHours(23),t.setMinutes(59),t.setSeconds(59);var a=new Date;a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setTime(a.getTime()-31536e6),e.$emit("pick",[a,t])}}]},curr_serach_node_path:"",alarmds:[{id:0,name:"已收敛"},{id:1,name:"已告警"}]}},created:function(){this.getData()},components:{},computed:{data:function(){return{tableData:this.$store.state.alarmdItems.data,detailData:this.$store.state.hdetailData.data,historyCounts:this.$store.state.historyData.total}}},watch:{filterText:function(e){this.$refs.SlotMenuList.filter(e)}},methods:c(c({},Object(o["b"])(["getHistorys","changeOKHistory","getDetailHistory","alarmingItems","getLogHistoryPdls","getAlarmDelay","getPrivNodes","getTreeMenus","getNodePathById","getSilenceRuleParam"])),{},{getData:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getTreeMenus();case 2:return t=JSON.parse(this.$store.state.treeMenus.data),this.nodes=t,e.next=6,this.getHistorys({page:this.cur_page,pageSize:this.page_size});case 6:this.tableData=this.$store.state.historyData.data,this.historyCounts=this.$store.state.historyData.total;case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),alarmDelay:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t,a){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getAlarmDelay({id:a.id});case 2:this.delayData=this.$store.state.delayData.data,this.delayDetailVisable=!0;case 4:case"end":return e.stop()}}),e,this)})));function t(t,a){return e.apply(this,arguments)}return t}(),historyPageHandler:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=null===this.dtrange?"":this.dtrange.length>0?this.dtrange.toString():"",e.next=3,this.getHistorys({node_path:this.curr_serach_node_path,level:this.level,dtrange:a,page:this.cur_page,pageSize:this.page_size});case 3:this.tableData=this.$store.state.historyData.data,this.historyCounts=this.$store.state.historyData.total;case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),setSearchNodeId:function(e){0!=e.length?this.node_id=e[e.length-1]:(this.node_id=void 0,this.curr_serach_node_path="")},searchHistoryHandler:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=null===this.dtrange?"":this.dtrange.length>0?this.dtrange.toString():"",void 0==this.node_id){e.next=5;break}return e.next=4,this.getNodePathById({id:this.node_id});case 4:this.curr_serach_node_path=this.$store.state.nodePath.data;case 5:return e.next=7,this.getHistorys({node_path:this.curr_serach_node_path,level:this.level,dtrange:t,page:this.cur_page,pageSize:this.page_size});case 7:this.tableData=this.$store.state.historyData.data,this.historyCounts=this.$store.state.historyData.total;case 9:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),maintain:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t,a){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getSilenceRuleParam({id:a.id});case 2:r=this.$store.state.silenceRuleParam.data,this.$router.push({path:"/silence?rule="+r});case 4:case"end":return e.stop()}}),e,this)})));function t(t,a){return e.apply(this,arguments)}return t}(),recoryHistory:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t,a){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(1!==a.status){e.next=3;break}return this.$message.error("已经是恢复状态!"),e.abrupt("return",!0);case 3:return e.next=5,this.changeOKHistory({id:a.id});case 5:return e.next=7,this.getHistorys({page:this.cur_page,pageSize:this.page_size});case 7:this.tableData=this.$store.state.historyData.data,this.historyCounts=this.$store.state.historyData.total;case 9:case"end":return e.stop()}}),e,this)})));function t(t,a){return e.apply(this,arguments)}return t}(),detail:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t,a){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getDetailHistory({id:a.id});case 2:this.detailData=this.$store.state.hdetailData.data,this.historyDetailVisable=!0;case 4:case"end":return e.stop()}}),e,this)})));function t(t,a){return e.apply(this,arguments)}return t}(),problemHandler:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.alarmingItems({page:this.cur_page,pageSize:this.page_size});case 2:this.tableData=this.$store.state.historyData.data,this.historyCounts=this.$store.state.historyData.total;case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),create:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.createNotify(this.notifyConfig);case 2:return e.next=4,this.getNotifys({page:this.cur_page,pageSize:this.page_size});case 4:this.tableData=this.$store.state.notifyData.data,this.notifyVisable=!1;case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),createHandler:function(){this.notifyVisable=!0}})},d=u,p=(a("ba1c"),a("0b56")),h=Object(p["a"])(d,r,n,!1,null,"747ae3b2",null);t["default"]=h.exports},"696b":function(e,t,a){},ba1c:function(e,t,a){"use strict";a("696b")}}]);